D∆∞·ªõi ƒë√¢y l√† h∆∞·ªõng d·∫´n chi ti·∫øt v·ªÅ **Tool Resolution** v√† **Observability** trong Spring AI:

---

### **1. Tool Resolution - Ph√¢n Gi·∫£i C√¥ng C·ª•**
#### **1.1. Kh√°i Ni·ªám C·ªët L√µi**
- **M·ª•c ƒë√≠ch**: ƒê·ªông ph√¢n gi·∫£i c√°c c√¥ng c·ª• (tools) th√¥ng qua t√™n, kh√¥ng c·∫ßn truy·ªÅn tr·ª±c ti·∫øp `ToolCallback`.
- **C∆° ch·∫ø**: S·ª≠ d·ª•ng `ToolCallbackResolver` ƒë·ªÉ √°nh x·∫° t√™n tool sang implementation t∆∞∆°ng ·ª©ng.

#### **1.2. C√°c Lo·∫°i Resolver**
1. **SpringBeanToolCallbackResolver**:
   - T·ª± ƒë·ªông ph√¢n gi·∫£i c√°c bean Spring d·∫°ng `Function`, `Supplier`, `Consumer`, `BiFunction`.
   - V√≠ d·ª•:
     ```java
     @Bean
     @Description("Chuy·ªÉn ƒë·ªïi nhi·ªát ƒë·ªô")
     public Function<ConversionRequest, Double> temperatureConverter() {
         return request -> { ... };
     }
     ```

2. **StaticToolCallbackResolver**:
   - Qu·∫£n l√Ω danh s√°ch `ToolCallback` tƒ©nh.
   - V√≠ d·ª•:
     ```java
     List<ToolCallback> tools = List.of(new WeatherTool(), new DateTimeTool());
     ToolCallbackResolver resolver = new StaticToolCallbackResolver(tools);
     ```

3. **DelegatingToolCallbackResolver**:
   - K·∫øt h·ª£p nhi·ªÅu resolver (∆∞u ti√™n theo th·ª© t·ª±).
   - C·∫•u h√¨nh m·∫∑c ƒë·ªãnh trong Spring Boot:
     ```java
     @Bean
     ToolCallbackResolver delegatingResolver(List<ToolCallbackResolver> resolvers) {
         return new DelegatingToolCallbackResolver(resolvers);
     }
     ```

#### **1.3. Tri·ªÉn Khai Trong ·ª®ng D·ª•ng**
- **Client-side**: Ch·ªâ c·∫ßn truy·ªÅn t√™n tool.
  ```java
  ChatClient.create(chatModel)
      .prompt("Ki·ªÉm tra th·ªùi ti·∫øt")
      .tools("weatherTool") // T√™n tool ƒë√£ ƒëƒÉng k√Ω
      .call();
  ```

- **Server-side**: T·ª± ƒë·ªông ph√¢n gi·∫£i qua `ToolCallbackResolver`.
  ```java
  public class CustomResolver implements ToolCallbackResolver {
      @Override
      public ToolCallback resolve(String toolName) {
          if ("weatherTool".equals(toolName)) {
              return new WeatherTool();
          }
          return null;
      }
  }
  ```

---

### **2. Observability & Logging**
#### **2.1. B·∫≠t Logging ƒê·ªÉ Theo D√µi**
- **C·∫•u h√¨nh Log Level**:
  ```properties
  # application.properties
  logging.level.org.springframework.ai=DEBUG
  ```

- **K·∫øt Qu·∫£ Log M·∫´u**:
  ```
  DEBUG [main] o.s.a.t.ToolCallingManager - Resolved tool: weatherTool
  DEBUG [main] o.s.a.t.ToolCallingManager - Executing tool 'weatherTool' with input: {"city":"Hanoi"}
  ```

#### **2.2. V√≠ D·ª• Debug Tool Resolution**
```java
@Bean
ToolCallbackResolver debugResolver() {
    return new ToolCallbackResolver() {
        @Override
        public ToolCallback resolve(String toolName) {
            System.out.println("Y√™u c·∫ßu ph√¢n gi·∫£i tool: " + toolName);
            // Logic ph√¢n gi·∫£i...
            return ...;
        }
    };
}
```

---

### **3. V√≠ D·ª• T·ªïng H·ª£p**
#### **3.1. ƒê·ªãnh Nghƒ©a Tool qua Bean**
```java
@Configuration
public class ToolConfig {
    
    @Bean
    @Description("L·∫•y t·ª∑ gi√° ti·ªÅn t·ªá")
    public Function<CurrencyRequest, Double> currencyConverter() {
        return request -> exchangeService.getRate(request.from(), request.to());
    }
}
```

#### **3.2. S·ª≠ D·ª•ng Trong ChatClient**
```java
ChatResponse response = ChatClient.create(chatModel)
    .prompt("Chuy·ªÉn 100 USD sang VND")
    .tools("currencyConverter") // T√™n bean
    .call();
```

#### **3.3. C·∫•u H√¨nh Resolver T√πy Ch·ªânh**
```java
@Bean
ToolCallbackResolver customResolver() {
    return new DelegatingToolCallbackResolver(List.of(
        new SpringBeanToolCallbackResolver(applicationContext),
        new StaticToolCallbackResolver(List.of(new CustomTool()))
    ));
}
```

---

### **4. Best Practices**
1. **ƒê·∫∑t T√™n Tool R√µ R√†ng**:
   ```java
   @Bean("weatherTool")
   public Function<WeatherRequest, WeatherResponse> getWeather() { ... }
   ```

2. **X·ª≠ L√Ω Tool Kh√¥ng T√¨m Th·∫•y**:
   ```java
   @Override
   public ToolCallback resolve(String toolName) {
       ToolCallback tool = ...;
       if (tool == null) {
           throw new ToolResolutionException("Tool kh√¥ng t·ªìn t·∫°i: " + toolName);
       }
       return tool;
   }
   ```

3. **K·∫øt H·ª£p Nhi·ªÅu Ngu·ªìn Resolver**:
   - ∆Øu ti√™n resolver t√πy ch·ªânh tr∆∞·ªõc resolver m·∫∑c ƒë·ªãnh.

---

### **K·∫øt Lu·∫≠n**
- **Tool Resolution** gi√∫p qu·∫£n l√Ω linh ho·∫°t c√°c c√¥ng c·ª• th√¥ng qua t√™n.
- **Logging** l√† c√¥ng c·ª• m·∫°nh ƒë·ªÉ debug qu√° tr√¨nh ph√¢n gi·∫£i v√† th·ª±c thi.
- K·∫øt h·ª£p resolver m·∫∑c ƒë·ªãnh v√† t√πy ch·ªânh ƒë·ªÉ x√¢y d·ª±ng h·ªá th·ªëng m·∫°nh m·∫Ω.

√Åp d·ª•ng c√°c k·ªπ thu·∫≠t tr√™n gi√∫p tƒÉng t√≠nh module h√≥a v√† d·ªÖ b·∫£o tr√¨ cho ·ª©ng d·ª•ng Spring AI c·ªßa b·∫°n! üöÄ