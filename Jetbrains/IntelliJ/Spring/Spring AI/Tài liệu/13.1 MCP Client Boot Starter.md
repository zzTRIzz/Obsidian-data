D∆∞·ªõi ƒë√¢y l√† h∆∞·ªõng d·∫´n chi ti·∫øt v·ªÅ **MCP Client Boot Starter** trong Spring AI:

---

### **1. T·ªïng Quan**
**MCP Client Boot Starter** gi√∫p t√≠ch h·ª£p Model Context Protocol (MCP) v√†o ·ª©ng d·ª•ng Spring Boot, h·ªó tr·ª£:
- K·∫øt n·ªëi ƒë·∫øn nhi·ªÅu MCP Server
- ƒê·ªìng b·ªô (SYNC) v√† B·∫•t ƒë·ªìng b·ªô (ASYNC)
- H·ªó tr·ª£ STDIO, HTTP SSE, WebFlux SSE
- T√≠ch h·ª£p v·ªõi Spring AI Tool Framework

---

### **2. Th√™m Dependency**
#### **2.1. Standard Client (SYNC)**
```xml
<dependency>
    <groupId>org.springframework.ai</groupId>
    <artifactId>spring-ai-starter-mcp-client</artifactId>
</dependency>
```

#### **2.2. WebFlux Client (ASYNC)**
```xml
<dependency>
    <groupId>org.springframework.ai</groupId>
    <artifactId>spring-ai-starter-mcp-client-webflux</artifactId>
</dependency>
```

---

### **3. C·∫•u H√¨nh Properties**
#### **3.1. C·∫•u H√¨nh Chung (`application.yml`)**
```yaml
spring:
  ai:
    mcp:
      client:
        enabled: true
        name: "weather-client"
        version: "1.0.0"
        type: SYNC # Ho·∫∑c ASYNC
        request-timeout: 30s
        toolcallback:
          enabled: true # T√≠ch h·ª£p v·ªõi Spring AI Tools
```

#### **3.2. K·∫øt N·ªëi SSE**
```yaml
spring:
  ai:
    mcp:
      client:
        sse:
          connections:
            weather-server:
              url: http://localhost:8080/mcp
            analytics-server:
              url: http://analytics.example.com/mcp
```

#### **3.3. K·∫øt N·ªëi STDIO**
```yaml
spring:
  ai:
    mcp:
      client:
        stdio:
          connections:
            local-server:
              command: "/path/to/mcp-server"
              args: ["--port=8080", "--mode=prod"]
              env:
                API_KEY: "your-secret-key"
```

---

### **4. T√πy Ch·ªânh Client**
#### **4.1. Custom Request Timeout**
```java
@Component
public class TimeoutCustomizer implements McpSyncClientCustomizer {
    @Override
    public void customize(String serverName, McpClient.SyncSpec spec) {
        spec.requestTimeout(Duration.ofSeconds(45));
    }
}
```

#### **4.2. X·ª≠ L√Ω Log T·ª´ Server**
```java
@Component
public class LoggingCustomizer implements McpSyncClientCustomizer {
    @Override
    public void customize(String serverName, McpClient.SyncSpec spec) {
        spec.loggingConsumer(log -> {
            System.out.printf("[%s] %s: %s%n", 
                log.level(), 
                log.source(), 
                log.message()
            );
        });
    }
}
```

---

### **5. S·ª≠ D·ª•ng Client Trong ·ª®ng D·ª•ng**
#### **5.1. Inject Client**
```java
@Autowired
private List<McpSyncClient> syncClients; // SYNC

@Autowired
private List<McpAsyncClient> asyncClients; // ASYNC
```

#### **5.2. G·ªçi Tool T·ª´ Server**
```java
public String getWeather(String city) {
    McpSyncClient client = syncClients.get(0);
    McpRequest request = McpRequest.createToolCall(
        "getWeather", 
        Map.of("city", city)
    );
    
    McpResponse response = client.send(request);
    return response.getResult().toString();
}
```

---

### **6. T√≠ch H·ª£p V·ªõi Spring AI Tools**
#### **6.1. K√≠ch Ho·∫°t Tool Callback**
```yaml
spring:
  ai:
    mcp:
      client:
        toolcallback:
          enabled: true
```

#### **6.2. S·ª≠ D·ª•ng Tool Trong ChatClient**
```java
@Autowired
private SyncMcpToolCallbackProvider toolProvider;

public void chatWithWeather() {
    ChatResponse response = ChatClient.create(chatModel)
        .prompt("Th·ªùi ti·∫øt H√† N·ªôi th·∫ø n√†o?")
        .tools(toolProvider.getToolCallbacks())
        .call();
    
    System.out.println(response.getContent());
}
```

---

### **7. X·ª≠ L√Ω L·ªói**
#### **7.1. B·∫Øt Exception**
```java
try {
    McpResponse response = client.send(request);
} catch (McpClientException e) {
    System.err.println("L·ªói k·∫øt n·ªëi: " + e.getMessage());
}
```

#### **7.2. Retry V·ªõi WebFlux (ASYNC)**
```java
client.sendAsync(request)
    .retry(3)
    .onErrorResume(e -> Mono.just(McpResponse.error("Fallback response")))
    .subscribe();
```

---

### **8. Best Practices**
1. **Ph√¢n Bi·ªát M√¥i Tr∆∞·ªùng**:
   - D√πng STDIO cho local development
   - D√πng SSE cho production

2. **Qu·∫£n L√Ω K·∫øt N·ªëi**:
   ```java
   @PreDestroy
   public void cleanup() {
       syncClients.forEach(McpSyncClient::close);
   }
   ```

3. **B·∫£o M·∫≠t**:
   - Kh√¥ng commit API keys trong file c·∫•u h√¨nh
   - S·ª≠ d·ª•ng environment variables cho th√¥ng tin nh·∫°y c·∫£m:
     ```yaml
     env:
       API_KEY: ${MCP_SERVER_KEY}
     ```

---

### **K·∫øt Lu·∫≠n**
V·ªõi MCP Client Boot Starter, b·∫°n c√≥ th·ªÉ:
- D·ªÖ d√†ng k·∫øt n·ªëi ƒë·∫øn c√°c MCP Server
- T√≠ch h·ª£p c√¥ng c·ª• AI v√†o h·ªá th·ªëng hi·ªán c√≥
- T√πy ch·ªânh linh ho·∫°t theo nhu c·∫ßu

K·∫øt h·ª£p v·ªõi Spring AI's Tool Framework t·∫°o ra h·ªá th·ªëng AI m·∫°nh m·∫Ω v√† d·ªÖ m·ªü r·ªông! üöÄ