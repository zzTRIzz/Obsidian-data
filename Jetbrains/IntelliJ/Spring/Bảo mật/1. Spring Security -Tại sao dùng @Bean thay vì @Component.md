 <br>

## 1. Báº£n cháº¥t cá»§a `@Bean` vs `@Component`

### `@Component`

- DÃ¹ng Ä‘á»ƒ Ä‘Ã¡nh dáº¥u **class do báº¡n tá»± viáº¿t**.
    
- Spring tá»± Ä‘á»™ng quÃ©t vÃ  táº¡o bean tá»« class Ä‘Ã³.
    

### `@Bean`

- ÄÆ°á»£c khai bÃ¡o trong method cá»§a class `@Configuration`.
    
- DÃ¹ng khi:
    
    - Cáº§n kiá»ƒm soÃ¡t logic khá»Ÿi táº¡o bean.
        
    - Lá»›p khÃ´ng thuá»™c codebase cá»§a báº¡n (vÃ­ dá»¥: tá»« Spring Security, JDBC, HTTP client).
        

## 2. Táº¡i sao Spring Security dÃ¹ng `@Bean`?

### a. Cáº¥u hÃ¬nh phá»©c táº¡p

Spring Security yÃªu cáº§u cáº¥u hÃ¬nh chi tiáº¿t cÃ¡c thÃ nh pháº§n nhÆ°:

- `SecurityFilterChain`: Äá»‹nh nghÄ©a rules báº£o máº­t (API nÃ o cáº§n xÃ¡c thá»±c, API nÃ o public).
    
- `PasswordEncoder`: Chá»n thuáº­t toÃ¡n mÃ£ hÃ³a máº­t kháº©u (`BCrypt`, `SCrypt`...).
    
- `CORS`, `CSRF`: TÃ¹y chá»‰nh cross-origin vÃ  chá»‘ng táº¥n cÃ´ng giáº£ máº¡o.
    

â†’ Nhá»¯ng cáº¥u hÃ¬nh nÃ y **khÃ´ng thá»ƒ** thá»±c hiá»‡n báº±ng `@Component` vÃ¬ chÃºng yÃªu cáº§u logic khá»Ÿi táº¡o phá»©c táº¡p.

### b. Spring Security cung cáº¥p sáºµn cÃ¡c interface/class

CÃ¡c class nhÆ° `HttpSecurity`, `SecurityFilterChain`, `PasswordEncoder` Ä‘Ã£ Ä‘Æ°á»£c Spring Security Ä‘á»‹nh nghÄ©a sáºµn. Báº¡n khÃ´ng thá»ƒ thÃªm `@Component` vÃ o chÃºng vÃ¬:

- ChÃºng thuá»™c vá» framework, khÃ´ng pháº£i code cá»§a báº¡n.
    
- Báº¡n cáº§n tÃ¹y chá»‰nh cÃ¡ch khá»Ÿi táº¡o chÃºng (vÃ­ dá»¥: cáº¥u hÃ¬nh CORS, session management).
    

## 3. VÃ­ dá»¥ minh há»a

### TrÆ°á»ng há»£p dÃ¹ng `@Bean` (báº¯t buá»™c)

```java
@Configuration
@EnableWebSecurity
public class SecurityConfig {

    // Pháº£i dÃ¹ng @Bean vÃ¬ SecurityFilterChain lÃ  interface cá»§a Spring Security
    @Bean
    public SecurityFilterChain securityFilterChain(HttpSecurity http) throws Exception {
        http
            .authorizeRequests(auth -> auth
                .requestMatchers("/admin/**").hasRole("ADMIN")
                .anyRequest().permitAll()
            );
        return http.build();
    }

    // BCryptPasswordEncoder lÃ  class tá»« thÆ° viá»‡n Spring Security
    @Bean
    public PasswordEncoder passwordEncoder() {
        return new BCryptPasswordEncoder();
    }
}
```

### TrÆ°á»ng há»£p dÃ¹ng `@Component` (náº¿u cÃ³)

Giáº£ sá»­ báº¡n tá»± viáº¿t má»™t lá»›p `CustomUserDetailsService` Ä‘á»ƒ load user tá»« database:

```java
@Component // ÄÆ°á»£c dÃ¹ng vÃ¬ Ä‘Ã¢y lÃ  class tá»± viáº¿t
public class CustomUserDetailsService implements UserDetailsService {
    @Override
    public UserDetails loadUserByUsername(String username) {
        // Logic load user tá»« database
    }
}
```

## 4. Táº¡i sao khÃ´ng dÃ¹ng `@Component` cho Spring Security?

- **KhÃ´ng thá»ƒ thÃªm annotation vÃ o class cá»§a framework**: Báº¡n khÃ´ng thá»ƒ sá»­a code cá»§a `HttpSecurity` hay `SecurityFilterChain` Ä‘á»ƒ thÃªm `@Component`.
    
- **Cáº§n truyá»n tham sá»‘ vÃ o method**: Khi cáº¥u hÃ¬nh `SecurityFilterChain`, báº¡n cáº§n inject `HttpSecurity` lÃ m tham sá»‘ â†’ Chá»‰ cÃ³ thá»ƒ thá»±c hiá»‡n qua method `@Bean`.
    

## 5. LÃ½ do dÃ¹ng `@Configuration`

- `@Configuration` lÃ  má»™t dáº¡ng Ä‘áº·c biá»‡t cá»§a `@Component`, Ä‘Ã¡nh dáº¥u lá»›p chá»©a cÃ¡c method `@Bean`.
    
- Spring xá»­ lÃ½ lá»›p `@Configuration` Ä‘áº·c biá»‡t:
    
    - Äáº£m báº£o cÃ¡c method `@Bean` chá»‰ Ä‘Æ°á»£c gá»i má»™t láº§n (singleton).
        
    - TrÃ¡nh táº¡o nhiá»u instance khÃ´ng cáº§n thiáº¿t.
        

## 6. Tá»•ng káº¿t

|Scenario|DÃ¹ng `@Bean`|DÃ¹ng `@Component`|
|---|---|---|
|Cáº¥u hÃ¬nh Spring Security (`SecurityFilterChain`, `PasswordEncoder`)|âœ…|âŒ|
|Class tá»± viáº¿t (Service, Repository)|âŒ|âœ…|
|TÃ­ch há»£p thÆ° viá»‡n ngoÃ i (`RestTemplate`, `ObjectMapper`)|âœ…|âŒ|
|Cáº§n truyá»n tham sá»‘ phá»©c táº¡p khi khá»Ÿi táº¡o|âœ…|âŒ|

### ğŸ“Œ **Káº¿t luáº­n**

Spring Security dÃ¹ng `@Bean` vÃ¬ nÃ³ yÃªu cáº§u **cáº¥u hÃ¬nh linh hoáº¡t** vÃ  lÃ m viá»‡c vá»›i cÃ¡c class tá»« framework!